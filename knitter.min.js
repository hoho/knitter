/*!
 * knitter v0.1.0, https://github.com/hoho/knitter
 * (c) 2015 Marat Abdullin, MIT license
 */
!function(t,e){"use strict";function o(t,n,r){if(!(this instanceof o))return new o(t,n,r);if(t instanceof Node||(t=e.querySelector(t)),n instanceof Node||(n=e.querySelector(n)),!r||r instanceof Node||(r=e.querySelector(r)),t instanceof Node&&n instanceof Node&&(!r||r&&r instanceof Node)){var i=this,s=i.node=e.createElement("div");i.id=a++,i.node1=t,i.node2=n,s.className="Knitter",(r||e.body).appendChild(s),i.update(!0)}}function n(o){for(var n,i=o.node,a=o.node1,d=o.node2,f=0,p=0,l=i;l&&l!==e.body;)l=l.parentNode;if(!l)return void delete s[o.id];for(l=i;l;){for(n=l.offsetParent;l&&l.offsetParent===n;)l=l.parentNode;l&&(f+=(l.offsetLeft||0)+(l.clientLeft||0),p+=(l.offsetTop||0)+(l.clientTop||0),console.log(l,l.offsetTop,l.clientTop))}o.id in s||(s[o.id]=o);var c,h,u=a.getBoundingClientRect(),m=d.getBoundingClientRect(),b=u.left,g=u.right,y=u.top,v=u.bottom,x=m.left,N=m.right,w=m.top,M=m.bottom,K=t.pageXOffset,T=t.pageYOffset,k=K+b+(g-b)/2,q=T+y+(v-y)/2,C=K+x+(N-x)/2,L=T+w+(M-w)/2;k>C&&(l=C,C=k,k=l,l=L,L=q,q=l,l=x,x=b,b=l,l=N,N=g,g=l,l=w,w=y,y=l,l=M,M=v,v=l);var E,S,B,O=(g-b)/2,P=(v-y)/2,R=(N-x)/2,z=(M-w)/2,A=(L-q)/(C-k),F=Math.atan(A),H=[[k+O,q+A*O],[k-O,q-A*O],[k+P/A,q+P],[k-P/A,q-P]],X=[[C+R,L+A*R],[C-R,L-A*R],[C+z/A,L+z],[C-z/A,L-z]];for(l=0;l<H.length;l++)if(c=H[l],c[0]>=k-O&&c[0]<=k+O&&c[1]>=q-P&&c[1]<=q+P)for(n=0;n<X.length;n++)h=X[n],h[0]>=C-R&&h[0]<=C+R&&h[1]>=L-z&&h[1]<=L+z&&(c[0]<C-R||c[0]>C+R||c[1]<L-z||c[1]>L+z)&&(S=r(c,h),(void 0===E||E>S)&&(E=S,B=c));E=Math.round(E)-6,l="transform:rotate("+F+"rad);",i.style.cssText=E>0?"display:block;left:"+Math.round(B[0]+3*Math.cos(F)-f)+"px;top:"+Math.round(B[1]+3*Math.sin(F)-p)+"px;width:"+E+"px;-webkit-"+l+"-ms-"+l+l:"display:none;"}function r(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}var i,a=1,s={},d=t.requestAnimationFrame||setTimeout;o.prototype.update=function(t){var e=this;t?d(function(){n(e)},0):n(e)},o.prototype.remove=function(){var t=this.node;t&&t.parentNode&&t.parentNode.removeChild(t),delete s[this.id]},t.Knitter=o,t.addEventListener("resize",function(){d(function(){for(var t in s)n(s[t])},0)}),i=e.createElement("style"),i.innerHTML=".Knitter{background:#000;display:none;height:2px;opacity:.4;position:absolute;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}.Knitter:after,.Knitter:before{border-bottom:30px solid transparent;border-bottom-style:inset;border-top:30px solid transparent;border-top-style:inset;content:'';height:0;margin:-29px -40px 0 0;position:absolute;-webkit-transform:scale(.1);-ms-transform:scale(.1);transform:scale(.1);width:0}.Knitter:before{border-right:90px solid #000;margin-left:-43px}.Knitter:after{border-left:90px solid #000;right:-3px}",e.head.appendChild(i)}(window,document);